# 管理端使用说明
以下管理指令都只接受**管理员**（`author.id`在`__SUPES`中的用户）触发；**全部子频道**指`__CHCTRL`、`__CHSTAT`、`__CH1`、`__CH2`、`__CH3`、`__CH4`、`__CH5`七个子频道，部分指令需在**特定子频道**触发，请注意区分。

## 子频道功能
- 会战管理子频道`__CHCTRL`：可响应所有`管理类指令`和`查询类指令`，主要用于对会战各类数据的直接操作，仅管理员可见，仅管理员可发言。
- 状态子频道`__CHSTAT`：可响应所有`查询类指令`、部分`管理类指令`和`报刀类指令`，主要用于推送面向全体成员的信息，全体成员可见，全体成员可发言。
- BOSS子频道`__CH1`\~`__CH5`：可响应所有`查询类指令`、`报刀类指令`和部分`管理类指令`，主要用于记录刀伤和推送对应BOSS相关的信息，全体成员可见，全体成员可发言。

## 归档
收到`归档`指令后，机器人会对数据库中的三张数据表`MEMBERS`（成员）、`STATUS`（BOSS状态）、`RECORDS`（出刀记录）进行**重命名**和**初始化**，方便公会留存会战数据。<br>
此指令需在**会战管理子频道**`__CHCTRL`下触发。<br>
此指令**包含**`刷新成员`、`重置状态`、`重置记录表`三条指令的相关功能，**无需**重复触发。
- 指令格式：`归档[备注]`
- 收到指令后，若有`[备注]`参数，机器人会按照`表名_备注`的格式进行重命名；若没有`[备注]`参数，机器人会获取收到指令时的时间戳，并按照`表名_时间戳`的格式进行重命名。
- 重命名和初始化操作**完成**后，机器人会在`__CHCTRL`下回复如下内容：
	- 成员列表归档`<成功|失败，错误详情>`
	- 成员列表重置`<成功|失败，错误详情>`
	- BOSS状态归档`<成功|失败，错误详情>`
	- BOSS状态重置`<成功|失败，错误详情>`
	- 出刀记录归档`<成功|失败，错误详情>`（出刀记录表`RECORDS`会在归档后的首次报刀时进行初始化）

## 刷新成员
收到`刷新成员`指令后，机器人会对数据库中的数据表`MEMBERS`（成员）进行**增删**。修改前的数据不作留存，修改后**无法回退**。<br>
此指令需在**会战管理子频道**`__CHCTRL`下触发。<br>
此指令**可以不手动触发**，在对数据表`MEMBERS`（成员）进行查询操作前，都会自动进行刷新。
- 指令格式：`刷新成员`
- 收到指令后，机器人会拉取**公会成员用户组**`__ROLEID`下的用户列表，并与已有数据进行比对。增加新加入的成员，删除已不在用户组中的成员，并将已有成员的昵称改为其当前的频道昵称。
- 刷新操作**完成**后，机器人会在`__CHCTRL`下回复如下内容：
	- 成员刷新`<成功|失败，错误详情>`

## 重置状态
收到`重置状态`指令后，机器人会对数据库中的数据表`STATUS`（BOSS状态）进行**初始化**。修改前的数据不作留存，修改后**无法回退**。<br>
此指令需在**会战管理子频道**`__CHCTRL`下触发。
- 指令格式：`重置状态`
- 收到指令后，机器人会初始化数据表，将BOSS状态重置为`一阶段1周目`。
- 初始化操作**完成**后，机器人会在`__CHCTRL`下回复如下内容：
	- BOSS状态重置`<成功|失败，错误详情>`
- 之后机器人会在**全部子频道**下推送`当前BOSS状态`。

## 重置记录表
收到`重置记录表`指令后，机器人会对数据库中的数据表`RECORDS`（出刀记录）进行**重命名**。为避免误触导致数据丢失，机器人不对此数据表进行删表操作，如有需要请**手动删除**。<br>
此指令需在**会战管理子频道**`__CHCTRL`下触发。
- 指令格式：`重置记录表`
- 收到指令后，机器人会获取收到指令时的时间戳，并按照`RECORDS_trash_时间戳`的格式进行重命名。
- 重命名操作**完成**后，机器人会在`__CHCTRL`下回复如下内容：
	- 记录表重置`<成功|失败，错误详情>`

## 调整进度
收到`调整`指令后，机器人会将`指定BOSS`的状态**无条件**修改为`指定周目`和`指定血量`，并对数据表`STATUS`（BOSS状态）进行相应更新。<br>
此指令可在**全部子频道**下触发。
- 指令格式：`调整<王><周目><血量>`，其中`<王>`、`<周目>`、`<血量>`三个**参数均用阿拉伯数字**表示，三个参数之间用**除阿拉伯数字外**的任意汉字或字符**分隔**；`<血量>`可以带单位，支持`千万/kw`、`万/w`、`千/k`，目标血量**不能超过**该BOSS在目标阶段的最高血量。
- 可接受格式举例，均以`1王 2周目 HP5,000,000`作为目标状态：
	- `调整1 2 5000000`
	- `调整进度1 2 5000000`
	- `调整血量1+2+5000000`
	- `调整1-2-500w`
	- `调整1王2周目500万`
	- `调整b1r2hp500w`
- 更新操作**完成**后，机器人会在`当前子频道`和**状态子频道**`__CHSTAT`下推送`当前BOSS状态`，在**被调整血量BOSS**的对应`BOSS子频道`下推送`该BOSS的新状态`。

## 催刀
收到`催刀`指令后，机器人会统计**公会成员用户组**`__ROLEID`下所有用户当日的出刀情况，并通过`@用户`对其进行提醒。<br>
此指令可在**全部子频道**下触发。
- 指令格式：`催[刀数|'补'|'补时']刀`，其中`刀数`是值位于[0, 9]之间的整数。
- 指令及其效果举例：
	- `催刀`，提醒当前**未出完3刀（包括持有补偿）**的所有成员
	- `催补刀`或`催补时刀`，提醒当前**持有待出补偿**的所有成员
	- `催2刀`，忽略补偿，提醒当前**已出完整刀和收尾刀共计2刀，还有1刀完整刀待出**的所有成员
	- `催7刀`，忽略补偿，提醒当前**已出完整刀和收尾刀共计7刀**的所有成员（一人多号等特殊情况）
- 当天被代（报）过刀的成员，无论是否在**公会成员用户组**`__ROLEID`中，都会收到相应提醒。
- 涉及10刀及以上的指令会被忽略，请通过`查刀`指令获取相关成员列表，手动进行提醒。
- 机器人会在**状态子频道**`__CHSTAT`下推送提醒消息。
- 催刀**失败**时，机器人会在`当前子频道`下回复相关错误信息；提醒操作**完成**后，机器人会在`当前子频道`下回复`@管理员 催刀信息已推送。`